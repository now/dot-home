#! @SHELL@

set -- --alternate-editor "" "$@"
test "x$TERM" != xdumb && set -- -t "$@"

if test -t 0; then
  exec emacsclient $@"
else
  : ${TMPDIR=/tmp}
  { d=`(umask 077 && mktemp -d "$TMPDIR/eXXXXXX") 2>/dev/null` &&
    test -n "$d" && test -d "$d"; } ||
    { d=$TMPDIR/e$$$RANDOM; (umask 077 && mkdir "$d") 2>/dev/null; } ||
    { printf "%s: canâ€™t create temporary directory" "`basename $0`"; exit 1; }
  trap 'rm -rf "$d"' 0 1 2 13 15
  t=$d/stdin
  cat > "$t" || exit 1
  emacsclient $@" "$t"
fi
