emulate -L zsh

if (( $# == 1 )) && [[ -f $1 ]]; then
  set $1:h
fi

local result="${${:-"$(builtin cd $* 2>&1 1>/dev/null)"}#cd:cd:1: }"
if (( $#result == 0 )); then
  builtin cd $*
else
  print -u 2 "cd: $result"
  return 1
fi
